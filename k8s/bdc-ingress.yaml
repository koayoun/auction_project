apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: front-app-ingress
  namespace: bdc105
  annotations:
    # TLS/SSL 설정
    kubernetes.io/tls-acme: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"

    # Nginx 설정
    nginx.ingress.kubernetes.io/ssl-redirect: "true"           # HTTP → HTTPS 자동 리디렉션
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"     # 강제 HTTPS
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"         # 업로드 파일 크기 제한 (React 앱용)

    # 헤더 설정 (Proxmox 환경 등에서 유용)
    nginx.ingress.kubernetes.io/use-forwarded-headers: "true"

    # 선택: IP 화이트리스트 (필요시 주석 해제)
    # nginx.ingress.kubernetes.io/whitelist-source-range: "182.213.11.0/24,211.44.192.110"

spec:
  ingressClassName: nginx

  # TLS 인증서 설정
  tls:
  - hosts:
    - www.bdc105.kro.kr
    secretName: bdc105-front-tls-cert  # Let's Encrypt가 자동 생성

  # 라우팅 규칙
  rules:
  - host: www.bdc105.kro.kr
    http:
      paths:
      # Frontend 라우팅 (모든 경로)
      - path: /
        pathType: Prefix
        backend:
          service:
            name: front-app-service  # ClusterIP Service 이름
            port:
              number: 80              # ClusterIP Service 포트

